{% extends 'base.html.twig' %}

{% block title %}Post{% endblock %}

{% block body %}
{% set categories = [] %}
{% for categorie in post.categorie %}
    {% set categories = categories|merge([categorie.nom]) %}
{% endfor %}
    <h1> Affichage test</h1>

    {% if post.format.nom == "article" %}
        <h2> block article</h2>
        {{ post.content|raw }}
    {% endif %} 

{#? Si le poste est un podcast  #}
    {% if post.format.nom == "audio" %}
        {#! composant react #}
        <div {{ react_component(
                'Audio', 
                {'src' : asset('/sound/Minamo.mp3'), 'post' : {
                    "id" : post.id,
                    "format" : post.format.nom,
                    "titre" : post.titre,
                    "categorie" : categories,

                    "format" : post.format.nom,
                    "slug" : post.slug,
                    }
                }
            )
            }}>
            Loading...
        </div>
         

    {% endif %} 

{#? Si le post est une video  #}

<h2> block video</h2>
    <video
        id="my-video"
        class="video-js"
        controls
        preload="auto"
        width="640"
        height="264"
        {# poster="MY_VIDEO_POSTER.jpg" #}
        data-setup="{}"
        >
        <source src="{{asset('Videos/Animation-liste-Noir.mp4')}}" type="video/mp4" />n
        <p class="vjs-no-js">
            To view this video please enable JavaScript, and consider upgrading to a web browser that

            <a href="https://videojs.com/html5-video-support/" target="_blank">
                supports HTML5 video
            </a>
        </p>
    </video>

{% endblock %}
    {% block script %}

    <script src="https://unpkg.com/siriwave/dist/siriwave.umd.min.js"></script>
    <script src="https://vjs.zencdn.net/8.3.0/video.min.js"></script>

    <script>
        const player = videojs('my-video')
           
            player.src ({type : 'video/mp4',
                        src : "{{asset('./Videos/animation_studio_Okai_AdobeExpress.mp4')}}" })
    
            player.on('ended',()=>{
                console.log('ready')
                player.src ({type : 'video/mp4',
                            src : "{{asset('./Videos/Animation-liste-Noir.mp4')}}" })

                player.ready(()=>{
                    player.play()
                    })
                })

    </script>        

    <script>

        // document.addEventListener('DOMContentLoaded', function() {
        //     let state = false;

        //     const siriWave = new SiriWave({
        //         container: document.getElementById("siri-container"),
        //         width: 640,
        //         height: 200,
        //         color: "#000",
        //     });
        //     siriWave.stop();
                
            
        //     const sound = new Howl({
        //         src: ['{{ asset("/sound/minamo.mp3") }}'],
        //         html5: true,
        //         volume: 0.5,
        //         onplayerror: function() {
        //             sound.once('unlock', function() {
        //                 sound.play();
        //             })
        //         }
        //     });
        //     document.querySelector('#play').addEventListener('click', function() {
        //         state = !state;
        //         if (state) {
        //             sound.play();
        //             siriWave.start();
        //         } else {
        //             sound.pause();
        //             siriWave.stop();
        //         }
        //     });
        // });
    </script>
            

{% endblock %}